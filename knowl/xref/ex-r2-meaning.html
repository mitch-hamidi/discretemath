<!DOCTYPE html>
<html lang="en-US" dir="ltr">
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
</head>
<body class="ignore-math">
<article class="exercise exercise-like"><h4 class="heading">
<span class="type">Exercise</span><span xmlns:pf="https://prefigure.org" class="space"> </span><span class="codenumber">12<span xmlns:pf="https://prefigure.org" class="period">.</span></span>
</h4>
<div xmlns:pf="https://prefigure.org" class="para">This problem is about the meaning of the coefficient of determination <span class="process-math">\(R^2\)</span> and its connection to variance, a topic that appears in the next section.  Throughout this problem, we consider the linear system <span class="process-math">\(A\xvec=\bvec\)</span> and the approximate least-squares solution <span class="process-math">\(\xhat\text{,}\)</span> where <span class="process-math">\(A\xhat=\bhat\text{.}\)</span>  We suppose that <span class="process-math">\(A\)</span> is an <span class="process-math">\(m\times n\)</span> matrix, and we will denote the <span class="process-math">\(m\)</span>-dimensional vector <span class="process-math">\(\onevec =
\fourvec11{\vdots}1\text{.}\)</span>
</div> <div xmlns:pf="https://prefigure.org" class="para logical"><ol class="lower-alpha" id="ex-r2-meaning-1-2-1">
<li><div class="para logical">
<div class="para">Explain why <span class="process-math">\(\bbar\text{,}\)</span> the mean of the components of <span class="process-math">\(\bvec\text{,}\)</span> can be found as the dot product</div>
<div class="displaymath process-math">
\begin{equation*}
\bbar = \frac 1m \bvec\cdot\onevec.
\end{equation*}
</div>
</div></li>
<li><div class="para">In the examples we have seen in this section, explain why <span class="process-math">\(\onevec\)</span> is in <span class="process-math">\(\col(A)\text{.}\)</span>
</div></li>
<li><div class="para logical">
<div class="para">If we write <span class="process-math">\(\bvec = \bhat + \bvec^\perp\text{,}\)</span> explain why</div>
<div class="displaymath process-math">
\begin{equation*}
\bvec^\perp\cdot\onevec = 0
\end{equation*}
</div>
<div class="para">and hence why the mean of the components of <span class="process-math">\(\bvec^\perp\)</span> is zero.</div>
</div></li>
<li>
<div class="para">The variance of an <span class="process-math">\(m\)</span>-dimensional vector <span class="process-math">\(\vvec\)</span> is <span class="process-math">\(\var(\vvec) = \frac1m \len{\widetilde{\vvec}}^2\text{,}\)</span> where <span class="process-math">\(\widetilde{\vvec}\)</span> is the vector obtained by demeaning <span class="process-math">\(\vvec\text{.}\)</span>
</div>
<div class="para logical">
<div class="para">Explain why</div>
<div class="displaymath process-math">
\begin{equation*}
\var(\bvec) = \var(\bhat) + \var(\bvec^\perp).
\end{equation*}
</div>
</div>
</li>
<li>
<div class="para logical">
<div class="para">Explain why</div>
<div class="displaymath process-math">
\begin{equation*}
\frac{\len{\bvec - A\xhat}^2}{\len{\widetilde{\bvec}}^2}
= \frac{\var(\bvec^\perp)}{\var(\bvec)}
\end{equation*}
</div>
<div class="para">and hence</div>
<div class="displaymath process-math">
\begin{equation*}
R^2 = \frac{\var(\bhat)}{\var(\bvec)} =
\frac{\var(A\xhat)}{\var(\bvec)}.
\end{equation*}
</div>
</div>
<div class="para">These expressions indicate why it is sometimes said that <span class="process-math">\(R^2\)</span> measures the “fraction of variance explained” by the function we are using to fit the data.  As seen in the previous exercise, there may be other features that are not recorded in the dataset that influence the quantity we wish to predict.</div>
</li>
<li><div class="para">Explain why <span class="process-math">\(0\leq R^2 \leq 1\text{.}\)</span>
</div></li>
</ol></div>
<div class="solutions">
<details xmlns:pf="https://prefigure.org" class="answer solution-like born-hidden-knowl"><summary class="knowl__link"><span class="type">Answer</span><span class="period">.</span></summary><div class="answer solution-like knowl__content"><div class="para logical"><ol class="lower-alpha" id="ex-r2-meaning-2-1-1">
<li><div class="para">
<span class="process-math">\(\bvec\cdot\onevec\)</span> simply sums the components of <span class="process-math">\(\bvec\text{.}\)</span>
</div></li>
<li><div class="para">
<span class="process-math">\(\onevec\)</span> is a column of <span class="process-math">\(A\text{.}\)</span>
</div></li>
<li><div class="para">
<span class="process-math">\(\bperp\)</span> is in <span class="process-math">\(\col(A)^\perp\text{.}\)</span>
</div></li>
<li><div class="para">Use the fact that <span class="process-math">\(\bhat\)</span> and <span class="process-math">\(\bperp\)</span> are orthogonal.</div></li>
<li><div class="para">This follows from <span class="process-math">\(\bvec = \bhat + \bperp\text{.}\)</span>
</div></li>
<li><div class="para">This follow from <span class="process-math">\(\var(\bvec) = \var(\bhat) +
\var(\bperp)\text{.}\)</span>
</div></li>
</ol></div></div></details><details xmlns:pf="https://prefigure.org" class="solution solution-like born-hidden-knowl"><summary class="knowl__link"><span class="type">Solution</span><span class="period">.</span></summary><div class="solution solution-like knowl__content"><div class="para logical"><ol class="lower-alpha" id="ex-r2-meaning-3-1-1">
<li><div class="para">
<span class="process-math">\(\bvec\cdot\onevec\)</span> simply sums the components of <span class="process-math">\(\bvec\text{.}\)</span>
</div></li>
<li><div class="para">The examples we’ve seen fit the data using functions that have a constant term such as <span class="process-math">\(y=\beta_0+\beta_1x\text{.}\)</span>  This means that <span class="process-math">\(\onevec\)</span> will be a column of the matrix <span class="process-math">\(A\)</span> and hence in <span class="process-math">\(\col(A)\text{.}\)</span>
</div></li>
<li><div class="para">Since <span class="process-math">\(\onevec\)</span> is in <span class="process-math">\(\col(A)\text{,}\)</span> any vector in <span class="process-math">\(\col(A)^\perp\text{,}\)</span> such as <span class="process-math">\(\bperp\text{,}\)</span> will be orthogonal to <span class="process-math">\(\onevec\text{.}\)</span>
</div></li>
<li><div class="para logical">
<div class="para">Notice that</div>
<div class="displaymath process-math">
\begin{equation*}
\bvec\cdot\onevec = \bhat\cdot\onevec +
\bperp\cdot\onevec = \bhat\cdot\onevec
\end{equation*}
</div>
<div class="para">which says that</div>
<div class="displaymath process-math">
\begin{equation*}
\widetilde{\bvec} = \widetilde{\bhat} + \bperp\text{.} 
\end{equation*}
</div>
<div class="para">Since <span class="process-math">\(\bhat\)</span> and <span class="process-math">\(\bperp\)</span> are orthogonal, we have <span class="process-math">\(\widetilde{\bhat}\cdot\bperp = 0\text{.}\)</span>  This means that</div>
<div class="displaymath process-math">
\begin{equation*}
|\widetilde{\bvec}|^2 =
(\widetilde{\bhat}+\bperp)\cdot 
(\widetilde{\bhat}+\bperp)
= |\widetilde{\bhat}|^2 + |\bperp|^2
\end{equation*}
</div>
<div class="para">so that <span class="process-math">\(\var(\bvec) = \var(\bhat)+\var(\bperp)\text{.}\)</span>
</div>
</div></li>
<li><div class="para logical">
<div class="para">
<span class="process-math">\(|\bvec-A\xhat|^2 = |\bvec-\bhat|^2 = |\bperp|^2\text{,}\)</span> which explains why</div>
<div class="displaymath process-math">
\begin{equation*}
\frac{\len{\bvec - A\xhat}^2}{\len{\widetilde{\bvec}}^2}
= \frac{\var(\bvec^\perp)}{\var(\bvec)}\text{.}
\end{equation*}
</div>
<div class="para">Then</div>
<div class="displaymath process-math">
\begin{equation*}
R^2 = 1 - 
\frac{\len{\bvec - A\xhat}^2}{\len{\widetilde{\bvec}}^2}
= 1-\frac{\var(\bvec^\perp)}{\var(\bvec)} =
\frac{\var(\bvec) - \var(\bperp)}{\var(\bvec)} =
\frac{\var(\bhat)}{\var(\bvec)}\text{.}
\end{equation*}
</div>
</div></li>
<li><div class="para logical">
<div class="para">The variances are nonnegative so we have <span class="process-math">\(R^2 \geq
0\text{.}\)</span>  Also,</div>
<div class="displaymath process-math">
\begin{equation*}
1 = \frac{\var(\bvec)}{\var(\bvec)} =
\frac{\var(\bhat)+\var(\bperp)}{\var(\bvec)} \geq
\frac{\var(\bhat)}{\var(\bvec)}=R^2\text{.}
\end{equation*}
</div>
</div></li>
</ol></div></div></details>
</div></article><span class="incontext"><a class="internal" href="sec-least-squares.html#ex-r2-meaning">in-context</a></span>
</body>
</html>
